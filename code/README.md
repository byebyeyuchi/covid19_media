model implementation code for METM and D-METM
